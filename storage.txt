[
    {"username":"Jeremy4","interest":["warcraft 3"]},

    {"username":"Chris","interest":["warcraft 3"]},

    {"username":"Kevin1","interest":["warcraft 3"," , Rick"]},

    {"username":"Rick","interest":["warcraft 3"," , LOTR"," , Ryan"]},

    {"username":"Wei","interest":["LOTR"," , Rick"]}

    ]


DROP TABLE users;
DROP TABLE interests;
CREATE TABLE interests (
interest_id INT GENERATED ALWAYS AS IDENTITY,
interest VARCHAR,
PRIMARY KEY(interest_id));
CREATE TABLE users (
_id INT GENERATED ALWAYS AS IDENTITY,
username VARCHAR UNIQUE,
password VARCHAR,
interest1 INT,
interest2 INT,
interest3 INT, 
FOREIGN KEY(interest1) REFERENCES interests(interest_id),
FOREIGN KEY(interest2) REFERENCES interests(interest_id),
FOREIGN KEY(interest3) REFERENCES interests(interest_id),
PRIMARY KEY(_id));


    
// Searching for users with specific interests
// app.get('/search', async (req, res) => {
//   const { preference1, preference2, preference3 } = req.query;
//   // console.log('query:', req.query);
//   const interestArr = [preference1, preference2, preference3];

//   const output = new Set();
//   try {
//     const usersWithInterests = await pool.query(
//       'SELECT users.username, personal_interests.interest FROM users JOIN personal_interests ON users.id = personal_interests.user_id WHERE personal_interests.interest = $1',
//       [preference1]
//     );
//     const usersWithInterests2 = await pool.query(
//       'SELECT users.username, personal_interests.interest FROM users JOIN personal_interests ON users.id = personal_interests.user_id WHERE personal_interests.interest = $1',
//       [preference2]
//     );
//     // console.log("TWO",usersWithInterests2.rows)
//     const usersWithInterests3 = await pool.query(
//       'SELECT users.username, personal_interests.interest FROM users JOIN personal_interests ON users.id = personal_interests.user_id WHERE personal_interests.interest = $1',
//       [preference3]
//     );
//     // console.log("THREE",usersWithInterests3.rows)

//     for (let i = 0; i < usersWithInterests.rows.length; i++) {
//       output.add(usersWithInterests.rows[i]);
//     }
//     // console.log(output);
//     for (let i = 0; i < usersWithInterests2.rows.length; i++) {
//       output.add(usersWithInterests2.rows[i]);
//     }
//     // console.log('2nd out', output);
//     for (let i = 0; i < usersWithInterests3.rows.length; i++) {
//       output.add(usersWithInterests3.rows[i]);
//     }
//     // console.log('3rd out', output);
//     console.log('hi');
//     if (output.length === 0) {
//       return res.status(404).json({ message: 'No users found' });
//     } else {
//       const arr = Array.from(output);
//       console.log('hello');
//       fs.writeFileSync('./server/public/storage.txt', JSON.stringify(arr));
//       res.redirect('http://localhost:8080/');
//     }
//   } catch (error) {
//     console.error('Error during search:', error);
//     res.status(500).json({ error: 'Search failed' });
//   }
// });

// app.get("/search", async (req, res) => {
// app.get('/search', async (req, res) => {
//   const { preference1, preference2, preference3 } = req.query;
//   console.log("query:",req.query)
//   const interestArr = [preference1,preference2,preference3];

//   const output = new Set()
//   try {
//     const usersWithInterests = await pool.query(
//       'SELECT users.username FROM users JOIN personal_interests ON users.id = personal_interests.user_id WHERE personal_interests.interest = $1',
//       [preference1]
//     );
//     const usersWithInterests2 = await pool.query(
//       'SELECT users.username FROM users JOIN personal_interests ON users.id = personal_interests.user_id WHERE personal_interests.interest = $1',
//       [preference2]
//     );
//     // console.log("TWO",usersWithInterests2.rows)
//     const usersWithInterests3 = await pool.query(
//       'SELECT users.username FROM users JOIN personal_interests ON users.id = personal_interests.user_id WHERE personal_interests.interest = $1',
//       [preference3]
//     );
//     // console.log("THREE",usersWithInterests3.rows)

//     for(let i=0;i<usersWithInterests.rows.length;i++){
//       output.add(usersWithInterests.rows[i].username)
//     }
//     console.log(output)
//     for(let i=0;i<usersWithInterests2.rows.length;i++){
//       output.add(usersWithInterests2.rows[i].username)
//     }
//     console.log('2nd out',output)
//     for(let i=0;i<usersWithInterests3.rows.length;i++){
//       output.add(usersWithInterests3.rows[i].username)
//     }
//     console.log('3rd out', output)

//     if (output.length === 0) {
//       return res.status(404).json({ message: "No users found" });
//     } else {
//       const arr = Array.from(output)
//       res.json(arr);
//     }
//   } catch (error) {
//     console.error('Error during search:', error);
//     res.status(500).json({ error: 'Search failed' });
//   }
// });